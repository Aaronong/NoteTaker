{% extends 'base.html' %}

{% load staticfiles %}

{% block head-extras %}
{% endblock %}

{% block content %}
    <h2>Secret header</h2>
    <h1>DOCUMENTS</h1>
    {% if all_documents %}

        {% for document, owner in all_documents.items %}
            <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                <div class="panel panel-primary">
                    <a href="/documents/{{ document.id }}/">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-xs-2">
                                    <i style="font-size:2.8em;" class="glyphicon glyphicon-file"></i>
                                </div>
                                <div class="col-xs-10 text-right">
                                    <div>{{ document.title }}</div>
                                </div>
                            </div>
                        </div>
                    </a>


                    <div class="panel-footer">

                        <!--footer element to link to author-->
                        <a href="/profile/{{ owner.id }}/">
                            <span class="pull-left">Authored by {{owner}}</span>
                        </a>

                        <!--footer element to share document-->
                        <a data-toggle="collapse" href="#ppladd{{document.id}}">
                            <span class="pull-right"><i style="font-size:1.5em;" class="glyphicon glyphicon-share"></i></span>
                        </a>
                        <div class="clearfix"></div>
                    </div>


                    <!--form for adding permissions-->


                    <div class="collapse" id="ppladd{{document.id}}">
                        <div class="panel-footer">

                                        <form class="card" method="POST">
                                            <div class="card-content">
                                                <div class="row">
                                                    {%csrf_token%}
                                                    <input type="hidden" name="post_type" value="ppl">
                                                    <input type="hidden" name="docid" value="{{ document.id }}">


                                                    <!--person to authorize-->
                                                    <label for="person" style="color:#337ab7;">&nbsp;&nbsp;&nbsp;&nbsp;Authorize </label>
                                                    <select class="selectpicker" id="person" name="person" title="choose a person">
                                                        {% for ppl in all_users %}
                                                            <option value="{{ ppl.id }}">{{ ppl.username }}</option>
                                                        {% endfor %}
                                                    </select>

                                                    <!--authorization type-->
                                                    <label for="authtype" style="color:#337ab7;"> to </label>
                                                    <select class="selectpicker" id="authtype" name="authtype" title="choose a authtype">
                                                            <option value="0">Read</option>
                                                            <option value="1">Write</option>
                                                            <option value="2">Comment</option>
                                                    </select>


                                                </div>
                                                <div class="row">
                                                    &nbsp;&nbsp;&nbsp;
                                                    <button type="submit" class="btn btn-primary">Submit</button>
                                                </div>
                                            </div>
                                        </form>

                        </div>
                    </div>

                    <!--end toggle stuff-->


                </div>
            </div>

        {% endfor %}



    {% endif %}

    <!--code for creating new document-->

    <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
        <div class="panel panel-primary" >
            <a data-toggle="collapse" href="#collapseExample">
                <div class="panel-heading">

                    <div class="row">
                        <div class="col-xs-2">
                            <i style="font-size:2.8em; color:#337ab7;" class="glyphicon glyphicon-plus"></i>
                        </div>
                        <div class="col-xs-10 text-right">
                            <p style="color:#337ab7;">Create New Document</p>
                        </div>
                    </div>

                </div>
            </a>

            <!--stuff the gets toggled-->
            <div class="collapse" id="collapseExample">
                <div class="panel-footer">

                    <form class="card" method="POST">
                        <div class="card-content">
                            <div class="row">
                                {%csrf_token%}
                                <input type="hidden" name="post_type" value="create">
                                <label for="title" style="color:#337ab7;">&nbsp;&nbsp;&nbsp;&nbsp;Title: </label>
                                <input id="title" type="text" name="title" style="background-color:white;color:#337ab7;">
                            </div>

                            {% if all_notebooks%}
                            <div class="row">
                                <div class="col-xs-8 col-lg-2">
                                    <label for="title" style="color:#337ab7;">Notebook: </label>
                                    <select class="selectpicker" id="selectnotebook" name="selectnotebook" title="choose a notebook">
                                        {% for nb in all_notebooks %}
                                            <option value="{{ nb.id }}">{{ nb }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            {% endif %}

                            <div class="row">
                                &nbsp;&nbsp;&nbsp;
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>

        </div>
    </div>

{% endblock %}